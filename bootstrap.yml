---

-  hosts: all
   become: true
   tasks:

     - name: install updates (CentOS)
       tags: always
       dnf:
         update_only: yes
         update_cache: yes
       when: ansible_distribution == "CentOS"

     - name: install updates (Ubuntu)
       tags: always
       apt:
         upgrade: dist
         update_cache: yes
       when: ansible_distribution == "Ubuntu"


-   hosts: all
    become: true
    tasks:

      - name: create simone user
        tags: always
        user:
          name: simone
          groups: root

      - name: add ssh key for simone
        tags: always
        authorized_key:
          user: simone 
          key: "ssh-ed25519 aaaajgkl;gpopkjhhjkdfjdfThfhiopkkfgkjbgkkln"

      - name: add sudoers file for simone
        tags: always
        copy:
          src: sudoer_simone
          dest: /etc/sudoers.d/simone
          owner: root
          group: root 


-   hosts: workstations
    become: true
    tasks: 
      - name: install unzip
        package:
          name: unzip

      - name: install terraform
        unarchive:
          src: https://releases.hashicorp.com/terraform/0.15.4/terraform_0.15.4_linux_amd64.zip
          dest: /usr/local/bin
          remote_src: yes
          mode: 0755
          owner: root
          group: root
          mode: 0440












       
